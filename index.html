<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Personas del Google Sheets</title>
</head>
<body>
    <h1>Personas</h1>
    <table id="tabla" border="1" cellpadding="5"></table>

<script>
const sheetID = "1MnsiIVJMz5APiHhynwdYZ2bfgLiY-OxEKiGA_uouJXU";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

fetch(url)
  .then(r => r.text())
  .then(txt => {
      const json = JSON.parse(txt.substring(47, txt.length - 2));
      const tabla = document.getElementById("tabla");

      // Encabezados
      const headers = json.table.cols.map(col => col.label);
      const trHead = document.createElement("tr");
      headers.forEach(h => {
          const th = document.createElement("th");
          th.textContent = h;
          trHead.appendChild(th);
      });
      tabla.appendChild(trHead);

      // Filas con las 4 celdas completas
      json.table.rows.forEach(fila => {
          const valores = fila.c.map(c => c ? c.v : "");

          // condición: las 4 columnas no vacías
          if (valores.length >= 4 && valores.slice(0,4).every(v => v !== "")) {
              const tr = document.createElement("tr");
              valores.slice(0,4).forEach(v => {
                  const td = document.createElement("td");
                  td.textContent = v;
                  tr.appendChild(td);
              });
              tabla.appendChild(tr);
          }
      });
  });
</script>

</body>
</html>
