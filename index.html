<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Datos desde Google Sheets</title>
</head>
<body>
    <h1>Datos del Google Sheets</h1>
    <table id="tabla"></table>

<script>
const sheetID = "1MnsiIVJMz5APiHhynwdYZ2bfgLiY-OxEKiGA_uouJXU";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

fetch(url)
  .then(res => res.text())
  .then(texto => {
      const json = JSON.parse(texto.substring(47, texto.length - 2));
      const tabla = document.getElementById("tabla");

      json.table.rows.forEach(fila => {
          const tr = document.createElement("tr");
          fila.c.forEach(celda => {
              const td = document.createElement("td");
              td.textContent = celda ? celda.v : "";
              tr.appendChild(td);
          });
          tabla.appendChild(tr);
      });
  });
</script>

</body>
</html>
